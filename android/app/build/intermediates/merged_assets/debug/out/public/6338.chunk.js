"use strict";(self.webpackChunkstudent_mis_mobile_app=self.webpackChunkstudent_mis_mobile_app||[]).push([[6338],{56338:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"iosTransitionAnimation\": () => (/* binding */ iosTransitionAnimation),\n/* harmony export */   \"shadow\": () => (/* binding */ shadow)\n/* harmony export */ });\n/* harmony import */ var _animation_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(35980);\n/* harmony import */ var _index4_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(55026);\n/*!\n * (C) Ionic http://ionicframework.com - MIT License\n */\n\n\n\nconst DURATION = 540;\nconst getClonedElement = (tagName) => {\n  return document.querySelector(`${tagName}.ion-cloned-element`);\n};\nconst shadow = (el) => {\n  return el.shadowRoot || el;\n};\nconst getLargeTitle = (refEl) => {\n  const tabs = refEl.tagName === 'ION-TABS' ? refEl : refEl.querySelector('ion-tabs');\n  const query = 'ion-content ion-header:not(.header-collapse-condense-inactive) ion-title.title-large';\n  if (tabs != null) {\n    const activeTab = tabs.querySelector('ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)');\n    return activeTab != null ? activeTab.querySelector(query) : null;\n  }\n  return refEl.querySelector(query);\n};\nconst getBackButton = (refEl, backDirection) => {\n  const tabs = refEl.tagName === 'ION-TABS' ? refEl : refEl.querySelector('ion-tabs');\n  let buttonsList = [];\n  if (tabs != null) {\n    const activeTab = tabs.querySelector('ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)');\n    if (activeTab != null) {\n      buttonsList = activeTab.querySelectorAll('ion-buttons');\n    }\n  }\n  else {\n    buttonsList = refEl.querySelectorAll('ion-buttons');\n  }\n  for (const buttons of buttonsList) {\n    const parentHeader = buttons.closest('ion-header');\n    const activeHeader = parentHeader && !parentHeader.classList.contains('header-collapse-condense-inactive');\n    const backButton = buttons.querySelector('ion-back-button');\n    const buttonsCollapse = buttons.classList.contains('buttons-collapse');\n    const startSlot = buttons.slot === 'start' || buttons.slot === '';\n    if (backButton !== null && startSlot && ((buttonsCollapse && activeHeader && backDirection) || !buttonsCollapse)) {\n      return backButton;\n    }\n  }\n  return null;\n};\nconst createLargeTitleTransition = (rootAnimation, rtl, backDirection, enteringEl, leavingEl) => {\n  const enteringBackButton = getBackButton(enteringEl, backDirection);\n  const leavingLargeTitle = getLargeTitle(leavingEl);\n  const enteringLargeTitle = getLargeTitle(enteringEl);\n  const leavingBackButton = getBackButton(leavingEl, backDirection);\n  const shouldAnimationForward = enteringBackButton !== null && leavingLargeTitle !== null && !backDirection;\n  const shouldAnimationBackward = enteringLargeTitle !== null && leavingBackButton !== null && backDirection;\n  if (shouldAnimationForward) {\n    const leavingLargeTitleBox = leavingLargeTitle.getBoundingClientRect();\n    const enteringBackButtonBox = enteringBackButton.getBoundingClientRect();\n    animateLargeTitle(rootAnimation, rtl, backDirection, leavingLargeTitle, leavingLargeTitleBox, enteringBackButtonBox);\n    animateBackButton(rootAnimation, rtl, backDirection, enteringBackButton, leavingLargeTitleBox, enteringBackButtonBox);\n  }\n  else if (shouldAnimationBackward) {\n    const enteringLargeTitleBox = enteringLargeTitle.getBoundingClientRect();\n    const leavingBackButtonBox = leavingBackButton.getBoundingClientRect();\n    animateLargeTitle(rootAnimation, rtl, backDirection, enteringLargeTitle, enteringLargeTitleBox, leavingBackButtonBox);\n    animateBackButton(rootAnimation, rtl, backDirection, leavingBackButton, enteringLargeTitleBox, leavingBackButtonBox);\n  }\n  return {\n    forward: shouldAnimationForward,\n    backward: shouldAnimationBackward,\n  };\n};\nconst animateBackButton = (rootAnimation, rtl, backDirection, backButtonEl, largeTitleBox, backButtonBox) => {\n  const BACK_BUTTON_START_OFFSET = rtl ? `calc(100% - ${backButtonBox.right + 4}px)` : `${backButtonBox.left - 4}px`;\n  const START_TEXT_TRANSLATE = rtl ? '7px' : '-7px';\n  const END_TEXT_TRANSLATE = rtl ? '-4px' : '4px';\n  const ICON_TRANSLATE = rtl ? '-4px' : '4px';\n  const TEXT_ORIGIN_X = rtl ? 'right' : 'left';\n  const ICON_ORIGIN_X = rtl ? 'left' : 'right';\n  const FORWARD_TEXT_KEYFRAMES = [\n    {\n      offset: 0,\n      opacity: 0,\n      transform: `translate3d(${START_TEXT_TRANSLATE}, ${largeTitleBox.top - 40}px, 0) scale(2.1)`,\n    },\n    { offset: 1, opacity: 1, transform: `translate3d(${END_TEXT_TRANSLATE}, ${backButtonBox.top - 46}px, 0) scale(1)` },\n  ];\n  const BACKWARD_TEXT_KEYFRAMES = [\n    { offset: 0, opacity: 1, transform: `translate3d(${END_TEXT_TRANSLATE}, ${backButtonBox.top - 46}px, 0) scale(1)` },\n    { offset: 0.6, opacity: 0 },\n    {\n      offset: 1,\n      opacity: 0,\n      transform: `translate3d(${START_TEXT_TRANSLATE}, ${largeTitleBox.top - 40}px, 0) scale(2.1)`,\n    },\n  ];\n  const TEXT_KEYFRAMES = backDirection ? BACKWARD_TEXT_KEYFRAMES : FORWARD_TEXT_KEYFRAMES;\n  const FORWARD_ICON_KEYFRAMES = [\n    { offset: 0, opacity: 0, transform: `translate3d(${ICON_TRANSLATE}, ${backButtonBox.top - 41}px, 0) scale(0.6)` },\n    { offset: 1, opacity: 1, transform: `translate3d(${ICON_TRANSLATE}, ${backButtonBox.top - 46}px, 0) scale(1)` },\n  ];\n  const BACKWARD_ICON_KEYFRAMES = [\n    { offset: 0, opacity: 1, transform: `translate3d(${ICON_TRANSLATE}, ${backButtonBox.top - 46}px, 0) scale(1)` },\n    { offset: 0.2, opacity: 0, transform: `translate3d(${ICON_TRANSLATE}, ${backButtonBox.top - 41}px, 0) scale(0.6)` },\n    { offset: 1, opacity: 0, transform: `translate3d(${ICON_TRANSLATE}, ${backButtonBox.top - 41}px, 0) scale(0.6)` },\n  ];\n  const ICON_KEYFRAMES = backDirection ? BACKWARD_ICON_KEYFRAMES : FORWARD_ICON_KEYFRAMES;\n  const enteringBackButtonTextAnimation = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n  const enteringBackButtonIconAnimation = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n  const clonedBackButtonEl = getClonedElement('ion-back-button');\n  const backButtonTextEl = shadow(clonedBackButtonEl).querySelector('.button-text');\n  const backButtonIconEl = shadow(clonedBackButtonEl).querySelector('ion-icon');\n  clonedBackButtonEl.text = backButtonEl.text;\n  clonedBackButtonEl.mode = backButtonEl.mode;\n  clonedBackButtonEl.icon = backButtonEl.icon;\n  clonedBackButtonEl.color = backButtonEl.color;\n  clonedBackButtonEl.disabled = backButtonEl.disabled;\n  clonedBackButtonEl.style.setProperty('display', 'block');\n  clonedBackButtonEl.style.setProperty('position', 'fixed');\n  enteringBackButtonIconAnimation.addElement(backButtonIconEl);\n  enteringBackButtonTextAnimation.addElement(backButtonTextEl);\n  enteringBackButtonTextAnimation\n    .beforeStyles({\n    'transform-origin': `${TEXT_ORIGIN_X} center`,\n  })\n    .beforeAddWrite(() => {\n    backButtonEl.style.setProperty('display', 'none');\n    clonedBackButtonEl.style.setProperty(TEXT_ORIGIN_X, BACK_BUTTON_START_OFFSET);\n  })\n    .afterAddWrite(() => {\n    backButtonEl.style.setProperty('display', '');\n    clonedBackButtonEl.style.setProperty('display', 'none');\n    clonedBackButtonEl.style.removeProperty(TEXT_ORIGIN_X);\n  })\n    .keyframes(TEXT_KEYFRAMES);\n  enteringBackButtonIconAnimation\n    .beforeStyles({\n    'transform-origin': `${ICON_ORIGIN_X} center`,\n  })\n    .keyframes(ICON_KEYFRAMES);\n  rootAnimation.addAnimation([enteringBackButtonTextAnimation, enteringBackButtonIconAnimation]);\n};\nconst animateLargeTitle = (rootAnimation, rtl, backDirection, largeTitleEl, largeTitleBox, backButtonBox) => {\n  const TITLE_START_OFFSET = rtl ? `calc(100% - ${largeTitleBox.right}px)` : `${largeTitleBox.left}px`;\n  const START_TRANSLATE = rtl ? '-18px' : '18px';\n  const ORIGIN_X = rtl ? 'right' : 'left';\n  const BACKWARDS_KEYFRAMES = [\n    { offset: 0, opacity: 0, transform: `translate3d(${START_TRANSLATE}, ${backButtonBox.top - 4}px, 0) scale(0.49)` },\n    { offset: 0.1, opacity: 0 },\n    { offset: 1, opacity: 1, transform: `translate3d(0, ${largeTitleBox.top - 2}px, 0) scale(1)` },\n  ];\n  const FORWARDS_KEYFRAMES = [\n    { offset: 0, opacity: 0.99, transform: `translate3d(0, ${largeTitleBox.top - 2}px, 0) scale(1)` },\n    { offset: 0.6, opacity: 0 },\n    { offset: 1, opacity: 0, transform: `translate3d(${START_TRANSLATE}, ${backButtonBox.top - 4}px, 0) scale(0.5)` },\n  ];\n  const KEYFRAMES = backDirection ? BACKWARDS_KEYFRAMES : FORWARDS_KEYFRAMES;\n  const clonedTitleEl = getClonedElement('ion-title');\n  const clonedLargeTitleAnimation = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n  clonedTitleEl.innerText = largeTitleEl.innerText;\n  clonedTitleEl.size = largeTitleEl.size;\n  clonedTitleEl.color = largeTitleEl.color;\n  clonedLargeTitleAnimation.addElement(clonedTitleEl);\n  clonedLargeTitleAnimation\n    .beforeStyles({\n    'transform-origin': `${ORIGIN_X} center`,\n    height: '46px',\n    display: '',\n    position: 'relative',\n    [ORIGIN_X]: TITLE_START_OFFSET,\n  })\n    .beforeAddWrite(() => {\n    largeTitleEl.style.setProperty('display', 'none');\n  })\n    .afterAddWrite(() => {\n    largeTitleEl.style.setProperty('display', '');\n    clonedTitleEl.style.setProperty('display', 'none');\n  })\n    .keyframes(KEYFRAMES);\n  rootAnimation.addAnimation(clonedLargeTitleAnimation);\n};\nconst iosTransitionAnimation = (navEl, opts) => {\n  try {\n    const EASING = 'cubic-bezier(0.32,0.72,0,1)';\n    const OPACITY = 'opacity';\n    const TRANSFORM = 'transform';\n    const CENTER = '0%';\n    const OFF_OPACITY = 0.8;\n    const isRTL = navEl.ownerDocument.dir === 'rtl';\n    const OFF_RIGHT = isRTL ? '-99.5%' : '99.5%';\n    const OFF_LEFT = isRTL ? '33%' : '-33%';\n    const enteringEl = opts.enteringEl;\n    const leavingEl = opts.leavingEl;\n    const backDirection = opts.direction === 'back';\n    const contentEl = enteringEl.querySelector(':scope > ion-content');\n    const headerEls = enteringEl.querySelectorAll(':scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *');\n    const enteringToolBarEls = enteringEl.querySelectorAll(':scope > ion-header > ion-toolbar');\n    const rootAnimation = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n    const enteringContentAnimation = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n    rootAnimation\n      .addElement(enteringEl)\n      .duration(opts.duration || DURATION)\n      .easing(opts.easing || EASING)\n      .fill('both')\n      .beforeRemoveClass('ion-page-invisible');\n    if (leavingEl && navEl) {\n      const navDecorAnimation = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n      navDecorAnimation.addElement(navEl);\n      rootAnimation.addAnimation(navDecorAnimation);\n    }\n    if (!contentEl && enteringToolBarEls.length === 0 && headerEls.length === 0) {\n      enteringContentAnimation.addElement(enteringEl.querySelector(':scope > .ion-page, :scope > ion-nav, :scope > ion-tabs')); // REVIEW\n    }\n    else {\n      enteringContentAnimation.addElement(contentEl); // REVIEW\n      enteringContentAnimation.addElement(headerEls);\n    }\n    rootAnimation.addAnimation(enteringContentAnimation);\n    if (backDirection) {\n      enteringContentAnimation\n        .beforeClearStyles([OPACITY])\n        .fromTo('transform', `translateX(${OFF_LEFT})`, `translateX(${CENTER})`)\n        .fromTo(OPACITY, OFF_OPACITY, 1);\n    }\n    else {\n      // entering content, forward direction\n      enteringContentAnimation\n        .beforeClearStyles([OPACITY])\n        .fromTo('transform', `translateX(${OFF_RIGHT})`, `translateX(${CENTER})`);\n    }\n    if (contentEl) {\n      const enteringTransitionEffectEl = shadow(contentEl).querySelector('.transition-effect');\n      if (enteringTransitionEffectEl) {\n        const enteringTransitionCoverEl = enteringTransitionEffectEl.querySelector('.transition-cover');\n        const enteringTransitionShadowEl = enteringTransitionEffectEl.querySelector('.transition-shadow');\n        const enteringTransitionEffect = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n        const enteringTransitionCover = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n        const enteringTransitionShadow = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n        enteringTransitionEffect\n          .addElement(enteringTransitionEffectEl)\n          .beforeStyles({ opacity: '1', display: 'block' })\n          .afterStyles({ opacity: '', display: '' });\n        enteringTransitionCover\n          .addElement(enteringTransitionCoverEl) // REVIEW\n          .beforeClearStyles([OPACITY])\n          .fromTo(OPACITY, 0, 0.1);\n        enteringTransitionShadow\n          .addElement(enteringTransitionShadowEl) // REVIEW\n          .beforeClearStyles([OPACITY])\n          .fromTo(OPACITY, 0.03, 0.7);\n        enteringTransitionEffect.addAnimation([enteringTransitionCover, enteringTransitionShadow]);\n        enteringContentAnimation.addAnimation([enteringTransitionEffect]);\n      }\n    }\n    const enteringContentHasLargeTitle = enteringEl.querySelector('ion-header.header-collapse-condense');\n    const { forward, backward } = createLargeTitleTransition(rootAnimation, isRTL, backDirection, enteringEl, leavingEl);\n    enteringToolBarEls.forEach((enteringToolBarEl) => {\n      const enteringToolBar = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n      enteringToolBar.addElement(enteringToolBarEl);\n      rootAnimation.addAnimation(enteringToolBar);\n      const enteringTitle = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n      enteringTitle.addElement(enteringToolBarEl.querySelector('ion-title')); // REVIEW\n      const enteringToolBarButtons = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n      const buttons = Array.from(enteringToolBarEl.querySelectorAll('ion-buttons,[menuToggle]'));\n      const parentHeader = enteringToolBarEl.closest('ion-header');\n      const inactiveHeader = parentHeader === null || parentHeader === void 0 ? void 0 : parentHeader.classList.contains('header-collapse-condense-inactive');\n      let buttonsToAnimate;\n      if (backDirection) {\n        buttonsToAnimate = buttons.filter((button) => {\n          const isCollapseButton = button.classList.contains('buttons-collapse');\n          return (isCollapseButton && !inactiveHeader) || !isCollapseButton;\n        });\n      }\n      else {\n        buttonsToAnimate = buttons.filter((button) => !button.classList.contains('buttons-collapse'));\n      }\n      enteringToolBarButtons.addElement(buttonsToAnimate);\n      const enteringToolBarItems = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n      enteringToolBarItems.addElement(enteringToolBarEl.querySelectorAll(':scope > *:not(ion-title):not(ion-buttons):not([menuToggle])'));\n      const enteringToolBarBg = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n      enteringToolBarBg.addElement(shadow(enteringToolBarEl).querySelector('.toolbar-background')); // REVIEW\n      const enteringBackButton = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n      const backButtonEl = enteringToolBarEl.querySelector('ion-back-button');\n      if (backButtonEl) {\n        enteringBackButton.addElement(backButtonEl);\n      }\n      enteringToolBar.addAnimation([\n        enteringTitle,\n        enteringToolBarButtons,\n        enteringToolBarItems,\n        enteringToolBarBg,\n        enteringBackButton,\n      ]);\n      enteringToolBarButtons.fromTo(OPACITY, 0.01, 1);\n      enteringToolBarItems.fromTo(OPACITY, 0.01, 1);\n      if (backDirection) {\n        if (!inactiveHeader) {\n          enteringTitle\n            .fromTo('transform', `translateX(${OFF_LEFT})`, `translateX(${CENTER})`)\n            .fromTo(OPACITY, 0.01, 1);\n        }\n        enteringToolBarItems.fromTo('transform', `translateX(${OFF_LEFT})`, `translateX(${CENTER})`);\n        // back direction, entering page has a back button\n        enteringBackButton.fromTo(OPACITY, 0.01, 1);\n      }\n      else {\n        // entering toolbar, forward direction\n        if (!enteringContentHasLargeTitle) {\n          enteringTitle\n            .fromTo('transform', `translateX(${OFF_RIGHT})`, `translateX(${CENTER})`)\n            .fromTo(OPACITY, 0.01, 1);\n        }\n        enteringToolBarItems.fromTo('transform', `translateX(${OFF_RIGHT})`, `translateX(${CENTER})`);\n        enteringToolBarBg.beforeClearStyles([OPACITY, 'transform']);\n        const translucentHeader = parentHeader === null || parentHeader === void 0 ? void 0 : parentHeader.translucent;\n        if (!translucentHeader) {\n          enteringToolBarBg.fromTo(OPACITY, 0.01, 'var(--opacity)');\n        }\n        else {\n          enteringToolBarBg.fromTo('transform', isRTL ? 'translateX(-100%)' : 'translateX(100%)', 'translateX(0px)');\n        }\n        // forward direction, entering page has a back button\n        if (!forward) {\n          enteringBackButton.fromTo(OPACITY, 0.01, 1);\n        }\n        if (backButtonEl && !forward) {\n          const enteringBackBtnText = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n          enteringBackBtnText\n            .addElement(shadow(backButtonEl).querySelector('.button-text')) // REVIEW\n            .fromTo(`transform`, isRTL ? 'translateX(-100px)' : 'translateX(100px)', 'translateX(0px)');\n          enteringToolBar.addAnimation(enteringBackBtnText);\n        }\n      }\n    });\n    // setup leaving view\n    if (leavingEl) {\n      const leavingContent = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n      const leavingContentEl = leavingEl.querySelector(':scope > ion-content');\n      const leavingToolBarEls = leavingEl.querySelectorAll(':scope > ion-header > ion-toolbar');\n      const leavingHeaderEls = leavingEl.querySelectorAll(':scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *');\n      if (!leavingContentEl && leavingToolBarEls.length === 0 && leavingHeaderEls.length === 0) {\n        leavingContent.addElement(leavingEl.querySelector(':scope > .ion-page, :scope > ion-nav, :scope > ion-tabs')); // REVIEW\n      }\n      else {\n        leavingContent.addElement(leavingContentEl); // REVIEW\n        leavingContent.addElement(leavingHeaderEls);\n      }\n      rootAnimation.addAnimation(leavingContent);\n      if (backDirection) {\n        // leaving content, back direction\n        leavingContent\n          .beforeClearStyles([OPACITY])\n          .fromTo('transform', `translateX(${CENTER})`, isRTL ? 'translateX(-100%)' : 'translateX(100%)');\n        const leavingPage = (0,_index4_js__WEBPACK_IMPORTED_MODULE_1__.g)(leavingEl);\n        rootAnimation.afterAddWrite(() => {\n          if (rootAnimation.getDirection() === 'normal') {\n            leavingPage.style.setProperty('display', 'none');\n          }\n        });\n      }\n      else {\n        // leaving content, forward direction\n        leavingContent\n          .fromTo('transform', `translateX(${CENTER})`, `translateX(${OFF_LEFT})`)\n          .fromTo(OPACITY, 1, OFF_OPACITY);\n      }\n      if (leavingContentEl) {\n        const leavingTransitionEffectEl = shadow(leavingContentEl).querySelector('.transition-effect');\n        if (leavingTransitionEffectEl) {\n          const leavingTransitionCoverEl = leavingTransitionEffectEl.querySelector('.transition-cover');\n          const leavingTransitionShadowEl = leavingTransitionEffectEl.querySelector('.transition-shadow');\n          const leavingTransitionEffect = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n          const leavingTransitionCover = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n          const leavingTransitionShadow = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n          leavingTransitionEffect\n            .addElement(leavingTransitionEffectEl)\n            .beforeStyles({ opacity: '1', display: 'block' })\n            .afterStyles({ opacity: '', display: '' });\n          leavingTransitionCover\n            .addElement(leavingTransitionCoverEl) // REVIEW\n            .beforeClearStyles([OPACITY])\n            .fromTo(OPACITY, 0.1, 0);\n          leavingTransitionShadow\n            .addElement(leavingTransitionShadowEl) // REVIEW\n            .beforeClearStyles([OPACITY])\n            .fromTo(OPACITY, 0.7, 0.03);\n          leavingTransitionEffect.addAnimation([leavingTransitionCover, leavingTransitionShadow]);\n          leavingContent.addAnimation([leavingTransitionEffect]);\n        }\n      }\n      leavingToolBarEls.forEach((leavingToolBarEl) => {\n        const leavingToolBar = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n        leavingToolBar.addElement(leavingToolBarEl);\n        const leavingTitle = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n        leavingTitle.addElement(leavingToolBarEl.querySelector('ion-title')); // REVIEW\n        const leavingToolBarButtons = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n        const buttons = leavingToolBarEl.querySelectorAll('ion-buttons,[menuToggle]');\n        const parentHeader = leavingToolBarEl.closest('ion-header');\n        const inactiveHeader = parentHeader === null || parentHeader === void 0 ? void 0 : parentHeader.classList.contains('header-collapse-condense-inactive');\n        const buttonsToAnimate = Array.from(buttons).filter((button) => {\n          const isCollapseButton = button.classList.contains('buttons-collapse');\n          return (isCollapseButton && !inactiveHeader) || !isCollapseButton;\n        });\n        leavingToolBarButtons.addElement(buttonsToAnimate);\n        const leavingToolBarItems = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n        const leavingToolBarItemEls = leavingToolBarEl.querySelectorAll(':scope > *:not(ion-title):not(ion-buttons):not([menuToggle])');\n        if (leavingToolBarItemEls.length > 0) {\n          leavingToolBarItems.addElement(leavingToolBarItemEls);\n        }\n        const leavingToolBarBg = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n        leavingToolBarBg.addElement(shadow(leavingToolBarEl).querySelector('.toolbar-background')); // REVIEW\n        const leavingBackButton = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n        const backButtonEl = leavingToolBarEl.querySelector('ion-back-button');\n        if (backButtonEl) {\n          leavingBackButton.addElement(backButtonEl);\n        }\n        leavingToolBar.addAnimation([\n          leavingTitle,\n          leavingToolBarButtons,\n          leavingToolBarItems,\n          leavingBackButton,\n          leavingToolBarBg,\n        ]);\n        rootAnimation.addAnimation(leavingToolBar);\n        // fade out leaving toolbar items\n        leavingBackButton.fromTo(OPACITY, 0.99, 0);\n        leavingToolBarButtons.fromTo(OPACITY, 0.99, 0);\n        leavingToolBarItems.fromTo(OPACITY, 0.99, 0);\n        if (backDirection) {\n          if (!inactiveHeader) {\n            // leaving toolbar, back direction\n            leavingTitle\n              .fromTo('transform', `translateX(${CENTER})`, isRTL ? 'translateX(-100%)' : 'translateX(100%)')\n              .fromTo(OPACITY, 0.99, 0);\n          }\n          leavingToolBarItems.fromTo('transform', `translateX(${CENTER})`, isRTL ? 'translateX(-100%)' : 'translateX(100%)');\n          leavingToolBarBg.beforeClearStyles([OPACITY, 'transform']);\n          // leaving toolbar, back direction, and there's no entering toolbar\n          // should just slide out, no fading out\n          const translucentHeader = parentHeader === null || parentHeader === void 0 ? void 0 : parentHeader.translucent;\n          if (!translucentHeader) {\n            leavingToolBarBg.fromTo(OPACITY, 'var(--opacity)', 0);\n          }\n          else {\n            leavingToolBarBg.fromTo('transform', 'translateX(0px)', isRTL ? 'translateX(-100%)' : 'translateX(100%)');\n          }\n          if (backButtonEl && !backward) {\n            const leavingBackBtnText = (0,_animation_js__WEBPACK_IMPORTED_MODULE_0__.c)();\n            leavingBackBtnText\n              .addElement(shadow(backButtonEl).querySelector('.button-text')) // REVIEW\n              .fromTo('transform', `translateX(${CENTER})`, `translateX(${(isRTL ? -124 : 124) + 'px'})`);\n            leavingToolBar.addAnimation(leavingBackBtnText);\n          }\n        }\n        else {\n          // leaving toolbar, forward direction\n          if (!inactiveHeader) {\n            leavingTitle\n              .fromTo('transform', `translateX(${CENTER})`, `translateX(${OFF_LEFT})`)\n              .fromTo(OPACITY, 0.99, 0)\n              .afterClearStyles([TRANSFORM, OPACITY]);\n          }\n          leavingToolBarItems\n            .fromTo('transform', `translateX(${CENTER})`, `translateX(${OFF_LEFT})`)\n            .afterClearStyles([TRANSFORM, OPACITY]);\n          leavingBackButton.afterClearStyles([OPACITY]);\n          leavingTitle.afterClearStyles([OPACITY]);\n          leavingToolBarButtons.afterClearStyles([OPACITY]);\n        }\n      });\n    }\n    return rootAnimation;\n  }\n  catch (err) {\n    throw err;\n  }\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE9BQU87QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QyxnREFBZTtBQUN0RDtBQUNBO0FBQ0EsaURBQWlELE9BQU8sa0JBQWtCLDRCQUE0QjtBQUN0RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlEQUFpRCxPQUFPLGtCQUFrQixTQUFTO0FBQ25GO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0NBQStDLE9BQU8sa0JBQWtCLFNBQVM7QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFMEMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zdHVkZW50LW1pcy1tb2JpbGUtYXBwLy4vbm9kZV9tb2R1bGVzL0Bpb25pYy9jb3JlL2NvbXBvbmVudHMvaW9zLnRyYW5zaXRpb24uanM/NTRlYSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIChDKSBJb25pYyBodHRwOi8vaW9uaWNmcmFtZXdvcmsuY29tIC0gTUlUIExpY2Vuc2VcbiAqL1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVBbmltYXRpb24gfSBmcm9tICcuL2FuaW1hdGlvbi5qcyc7XG5pbXBvcnQgeyBnIGFzIGdldElvblBhZ2VFbGVtZW50IH0gZnJvbSAnLi9pbmRleDQuanMnO1xuXG5jb25zdCBEVVJBVElPTiA9IDU0MDtcbmNvbnN0IGdldENsb25lZEVsZW1lbnQgPSAodGFnTmFtZSkgPT4ge1xuICByZXR1cm4gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgJHt0YWdOYW1lfS5pb24tY2xvbmVkLWVsZW1lbnRgKTtcbn07XG5jb25zdCBzaGFkb3cgPSAoZWwpID0+IHtcbiAgcmV0dXJuIGVsLnNoYWRvd1Jvb3QgfHwgZWw7XG59O1xuY29uc3QgZ2V0TGFyZ2VUaXRsZSA9IChyZWZFbCkgPT4ge1xuICBjb25zdCB0YWJzID0gcmVmRWwudGFnTmFtZSA9PT0gJ0lPTi1UQUJTJyA/IHJlZkVsIDogcmVmRWwucXVlcnlTZWxlY3RvcignaW9uLXRhYnMnKTtcbiAgY29uc3QgcXVlcnkgPSAnaW9uLWNvbnRlbnQgaW9uLWhlYWRlcjpub3QoLmhlYWRlci1jb2xsYXBzZS1jb25kZW5zZS1pbmFjdGl2ZSkgaW9uLXRpdGxlLnRpdGxlLWxhcmdlJztcbiAgaWYgKHRhYnMgIT0gbnVsbCkge1xuICAgIGNvbnN0IGFjdGl2ZVRhYiA9IHRhYnMucXVlcnlTZWxlY3RvcignaW9uLXRhYjpub3QoLnRhYi1oaWRkZW4pLCAuaW9uLXBhZ2U6bm90KC5pb24tcGFnZS1oaWRkZW4pJyk7XG4gICAgcmV0dXJuIGFjdGl2ZVRhYiAhPSBudWxsID8gYWN0aXZlVGFiLnF1ZXJ5U2VsZWN0b3IocXVlcnkpIDogbnVsbDtcbiAgfVxuICByZXR1cm4gcmVmRWwucXVlcnlTZWxlY3RvcihxdWVyeSk7XG59O1xuY29uc3QgZ2V0QmFja0J1dHRvbiA9IChyZWZFbCwgYmFja0RpcmVjdGlvbikgPT4ge1xuICBjb25zdCB0YWJzID0gcmVmRWwudGFnTmFtZSA9PT0gJ0lPTi1UQUJTJyA/IHJlZkVsIDogcmVmRWwucXVlcnlTZWxlY3RvcignaW9uLXRhYnMnKTtcbiAgbGV0IGJ1dHRvbnNMaXN0ID0gW107XG4gIGlmICh0YWJzICE9IG51bGwpIHtcbiAgICBjb25zdCBhY3RpdmVUYWIgPSB0YWJzLnF1ZXJ5U2VsZWN0b3IoJ2lvbi10YWI6bm90KC50YWItaGlkZGVuKSwgLmlvbi1wYWdlOm5vdCguaW9uLXBhZ2UtaGlkZGVuKScpO1xuICAgIGlmIChhY3RpdmVUYWIgIT0gbnVsbCkge1xuICAgICAgYnV0dG9uc0xpc3QgPSBhY3RpdmVUYWIucXVlcnlTZWxlY3RvckFsbCgnaW9uLWJ1dHRvbnMnKTtcbiAgICB9XG4gIH1cbiAgZWxzZSB7XG4gICAgYnV0dG9uc0xpc3QgPSByZWZFbC5xdWVyeVNlbGVjdG9yQWxsKCdpb24tYnV0dG9ucycpO1xuICB9XG4gIGZvciAoY29uc3QgYnV0dG9ucyBvZiBidXR0b25zTGlzdCkge1xuICAgIGNvbnN0IHBhcmVudEhlYWRlciA9IGJ1dHRvbnMuY2xvc2VzdCgnaW9uLWhlYWRlcicpO1xuICAgIGNvbnN0IGFjdGl2ZUhlYWRlciA9IHBhcmVudEhlYWRlciAmJiAhcGFyZW50SGVhZGVyLmNsYXNzTGlzdC5jb250YWlucygnaGVhZGVyLWNvbGxhcHNlLWNvbmRlbnNlLWluYWN0aXZlJyk7XG4gICAgY29uc3QgYmFja0J1dHRvbiA9IGJ1dHRvbnMucXVlcnlTZWxlY3RvcignaW9uLWJhY2stYnV0dG9uJyk7XG4gICAgY29uc3QgYnV0dG9uc0NvbGxhcHNlID0gYnV0dG9ucy5jbGFzc0xpc3QuY29udGFpbnMoJ2J1dHRvbnMtY29sbGFwc2UnKTtcbiAgICBjb25zdCBzdGFydFNsb3QgPSBidXR0b25zLnNsb3QgPT09ICdzdGFydCcgfHwgYnV0dG9ucy5zbG90ID09PSAnJztcbiAgICBpZiAoYmFja0J1dHRvbiAhPT0gbnVsbCAmJiBzdGFydFNsb3QgJiYgKChidXR0b25zQ29sbGFwc2UgJiYgYWN0aXZlSGVhZGVyICYmIGJhY2tEaXJlY3Rpb24pIHx8ICFidXR0b25zQ29sbGFwc2UpKSB7XG4gICAgICByZXR1cm4gYmFja0J1dHRvbjtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59O1xuY29uc3QgY3JlYXRlTGFyZ2VUaXRsZVRyYW5zaXRpb24gPSAocm9vdEFuaW1hdGlvbiwgcnRsLCBiYWNrRGlyZWN0aW9uLCBlbnRlcmluZ0VsLCBsZWF2aW5nRWwpID0+IHtcbiAgY29uc3QgZW50ZXJpbmdCYWNrQnV0dG9uID0gZ2V0QmFja0J1dHRvbihlbnRlcmluZ0VsLCBiYWNrRGlyZWN0aW9uKTtcbiAgY29uc3QgbGVhdmluZ0xhcmdlVGl0bGUgPSBnZXRMYXJnZVRpdGxlKGxlYXZpbmdFbCk7XG4gIGNvbnN0IGVudGVyaW5nTGFyZ2VUaXRsZSA9IGdldExhcmdlVGl0bGUoZW50ZXJpbmdFbCk7XG4gIGNvbnN0IGxlYXZpbmdCYWNrQnV0dG9uID0gZ2V0QmFja0J1dHRvbihsZWF2aW5nRWwsIGJhY2tEaXJlY3Rpb24pO1xuICBjb25zdCBzaG91bGRBbmltYXRpb25Gb3J3YXJkID0gZW50ZXJpbmdCYWNrQnV0dG9uICE9PSBudWxsICYmIGxlYXZpbmdMYXJnZVRpdGxlICE9PSBudWxsICYmICFiYWNrRGlyZWN0aW9uO1xuICBjb25zdCBzaG91bGRBbmltYXRpb25CYWNrd2FyZCA9IGVudGVyaW5nTGFyZ2VUaXRsZSAhPT0gbnVsbCAmJiBsZWF2aW5nQmFja0J1dHRvbiAhPT0gbnVsbCAmJiBiYWNrRGlyZWN0aW9uO1xuICBpZiAoc2hvdWxkQW5pbWF0aW9uRm9yd2FyZCkge1xuICAgIGNvbnN0IGxlYXZpbmdMYXJnZVRpdGxlQm94ID0gbGVhdmluZ0xhcmdlVGl0bGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgY29uc3QgZW50ZXJpbmdCYWNrQnV0dG9uQm94ID0gZW50ZXJpbmdCYWNrQnV0dG9uLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGFuaW1hdGVMYXJnZVRpdGxlKHJvb3RBbmltYXRpb24sIHJ0bCwgYmFja0RpcmVjdGlvbiwgbGVhdmluZ0xhcmdlVGl0bGUsIGxlYXZpbmdMYXJnZVRpdGxlQm94LCBlbnRlcmluZ0JhY2tCdXR0b25Cb3gpO1xuICAgIGFuaW1hdGVCYWNrQnV0dG9uKHJvb3RBbmltYXRpb24sIHJ0bCwgYmFja0RpcmVjdGlvbiwgZW50ZXJpbmdCYWNrQnV0dG9uLCBsZWF2aW5nTGFyZ2VUaXRsZUJveCwgZW50ZXJpbmdCYWNrQnV0dG9uQm94KTtcbiAgfVxuICBlbHNlIGlmIChzaG91bGRBbmltYXRpb25CYWNrd2FyZCkge1xuICAgIGNvbnN0IGVudGVyaW5nTGFyZ2VUaXRsZUJveCA9IGVudGVyaW5nTGFyZ2VUaXRsZS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBjb25zdCBsZWF2aW5nQmFja0J1dHRvbkJveCA9IGxlYXZpbmdCYWNrQnV0dG9uLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIGFuaW1hdGVMYXJnZVRpdGxlKHJvb3RBbmltYXRpb24sIHJ0bCwgYmFja0RpcmVjdGlvbiwgZW50ZXJpbmdMYXJnZVRpdGxlLCBlbnRlcmluZ0xhcmdlVGl0bGVCb3gsIGxlYXZpbmdCYWNrQnV0dG9uQm94KTtcbiAgICBhbmltYXRlQmFja0J1dHRvbihyb290QW5pbWF0aW9uLCBydGwsIGJhY2tEaXJlY3Rpb24sIGxlYXZpbmdCYWNrQnV0dG9uLCBlbnRlcmluZ0xhcmdlVGl0bGVCb3gsIGxlYXZpbmdCYWNrQnV0dG9uQm94KTtcbiAgfVxuICByZXR1cm4ge1xuICAgIGZvcndhcmQ6IHNob3VsZEFuaW1hdGlvbkZvcndhcmQsXG4gICAgYmFja3dhcmQ6IHNob3VsZEFuaW1hdGlvbkJhY2t3YXJkLFxuICB9O1xufTtcbmNvbnN0IGFuaW1hdGVCYWNrQnV0dG9uID0gKHJvb3RBbmltYXRpb24sIHJ0bCwgYmFja0RpcmVjdGlvbiwgYmFja0J1dHRvbkVsLCBsYXJnZVRpdGxlQm94LCBiYWNrQnV0dG9uQm94KSA9PiB7XG4gIGNvbnN0IEJBQ0tfQlVUVE9OX1NUQVJUX09GRlNFVCA9IHJ0bCA/IGBjYWxjKDEwMCUgLSAke2JhY2tCdXR0b25Cb3gucmlnaHQgKyA0fXB4KWAgOiBgJHtiYWNrQnV0dG9uQm94LmxlZnQgLSA0fXB4YDtcbiAgY29uc3QgU1RBUlRfVEVYVF9UUkFOU0xBVEUgPSBydGwgPyAnN3B4JyA6ICctN3B4JztcbiAgY29uc3QgRU5EX1RFWFRfVFJBTlNMQVRFID0gcnRsID8gJy00cHgnIDogJzRweCc7XG4gIGNvbnN0IElDT05fVFJBTlNMQVRFID0gcnRsID8gJy00cHgnIDogJzRweCc7XG4gIGNvbnN0IFRFWFRfT1JJR0lOX1ggPSBydGwgPyAncmlnaHQnIDogJ2xlZnQnO1xuICBjb25zdCBJQ09OX09SSUdJTl9YID0gcnRsID8gJ2xlZnQnIDogJ3JpZ2h0JztcbiAgY29uc3QgRk9SV0FSRF9URVhUX0tFWUZSQU1FUyA9IFtcbiAgICB7XG4gICAgICBvZmZzZXQ6IDAsXG4gICAgICBvcGFjaXR5OiAwLFxuICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlM2QoJHtTVEFSVF9URVhUX1RSQU5TTEFURX0sICR7bGFyZ2VUaXRsZUJveC50b3AgLSA0MH1weCwgMCkgc2NhbGUoMi4xKWAsXG4gICAgfSxcbiAgICB7IG9mZnNldDogMSwgb3BhY2l0eTogMSwgdHJhbnNmb3JtOiBgdHJhbnNsYXRlM2QoJHtFTkRfVEVYVF9UUkFOU0xBVEV9LCAke2JhY2tCdXR0b25Cb3gudG9wIC0gNDZ9cHgsIDApIHNjYWxlKDEpYCB9LFxuICBdO1xuICBjb25zdCBCQUNLV0FSRF9URVhUX0tFWUZSQU1FUyA9IFtcbiAgICB7IG9mZnNldDogMCwgb3BhY2l0eTogMSwgdHJhbnNmb3JtOiBgdHJhbnNsYXRlM2QoJHtFTkRfVEVYVF9UUkFOU0xBVEV9LCAke2JhY2tCdXR0b25Cb3gudG9wIC0gNDZ9cHgsIDApIHNjYWxlKDEpYCB9LFxuICAgIHsgb2Zmc2V0OiAwLjYsIG9wYWNpdHk6IDAgfSxcbiAgICB7XG4gICAgICBvZmZzZXQ6IDEsXG4gICAgICBvcGFjaXR5OiAwLFxuICAgICAgdHJhbnNmb3JtOiBgdHJhbnNsYXRlM2QoJHtTVEFSVF9URVhUX1RSQU5TTEFURX0sICR7bGFyZ2VUaXRsZUJveC50b3AgLSA0MH1weCwgMCkgc2NhbGUoMi4xKWAsXG4gICAgfSxcbiAgXTtcbiAgY29uc3QgVEVYVF9LRVlGUkFNRVMgPSBiYWNrRGlyZWN0aW9uID8gQkFDS1dBUkRfVEVYVF9LRVlGUkFNRVMgOiBGT1JXQVJEX1RFWFRfS0VZRlJBTUVTO1xuICBjb25zdCBGT1JXQVJEX0lDT05fS0VZRlJBTUVTID0gW1xuICAgIHsgb2Zmc2V0OiAwLCBvcGFjaXR5OiAwLCB0cmFuc2Zvcm06IGB0cmFuc2xhdGUzZCgke0lDT05fVFJBTlNMQVRFfSwgJHtiYWNrQnV0dG9uQm94LnRvcCAtIDQxfXB4LCAwKSBzY2FsZSgwLjYpYCB9LFxuICAgIHsgb2Zmc2V0OiAxLCBvcGFjaXR5OiAxLCB0cmFuc2Zvcm06IGB0cmFuc2xhdGUzZCgke0lDT05fVFJBTlNMQVRFfSwgJHtiYWNrQnV0dG9uQm94LnRvcCAtIDQ2fXB4LCAwKSBzY2FsZSgxKWAgfSxcbiAgXTtcbiAgY29uc3QgQkFDS1dBUkRfSUNPTl9LRVlGUkFNRVMgPSBbXG4gICAgeyBvZmZzZXQ6IDAsIG9wYWNpdHk6IDEsIHRyYW5zZm9ybTogYHRyYW5zbGF0ZTNkKCR7SUNPTl9UUkFOU0xBVEV9LCAke2JhY2tCdXR0b25Cb3gudG9wIC0gNDZ9cHgsIDApIHNjYWxlKDEpYCB9LFxuICAgIHsgb2Zmc2V0OiAwLjIsIG9wYWNpdHk6IDAsIHRyYW5zZm9ybTogYHRyYW5zbGF0ZTNkKCR7SUNPTl9UUkFOU0xBVEV9LCAke2JhY2tCdXR0b25Cb3gudG9wIC0gNDF9cHgsIDApIHNjYWxlKDAuNilgIH0sXG4gICAgeyBvZmZzZXQ6IDEsIG9wYWNpdHk6IDAsIHRyYW5zZm9ybTogYHRyYW5zbGF0ZTNkKCR7SUNPTl9UUkFOU0xBVEV9LCAke2JhY2tCdXR0b25Cb3gudG9wIC0gNDF9cHgsIDApIHNjYWxlKDAuNilgIH0sXG4gIF07XG4gIGNvbnN0IElDT05fS0VZRlJBTUVTID0gYmFja0RpcmVjdGlvbiA/IEJBQ0tXQVJEX0lDT05fS0VZRlJBTUVTIDogRk9SV0FSRF9JQ09OX0tFWUZSQU1FUztcbiAgY29uc3QgZW50ZXJpbmdCYWNrQnV0dG9uVGV4dEFuaW1hdGlvbiA9IGNyZWF0ZUFuaW1hdGlvbigpO1xuICBjb25zdCBlbnRlcmluZ0JhY2tCdXR0b25JY29uQW5pbWF0aW9uID0gY3JlYXRlQW5pbWF0aW9uKCk7XG4gIGNvbnN0IGNsb25lZEJhY2tCdXR0b25FbCA9IGdldENsb25lZEVsZW1lbnQoJ2lvbi1iYWNrLWJ1dHRvbicpO1xuICBjb25zdCBiYWNrQnV0dG9uVGV4dEVsID0gc2hhZG93KGNsb25lZEJhY2tCdXR0b25FbCkucXVlcnlTZWxlY3RvcignLmJ1dHRvbi10ZXh0Jyk7XG4gIGNvbnN0IGJhY2tCdXR0b25JY29uRWwgPSBzaGFkb3coY2xvbmVkQmFja0J1dHRvbkVsKS5xdWVyeVNlbGVjdG9yKCdpb24taWNvbicpO1xuICBjbG9uZWRCYWNrQnV0dG9uRWwudGV4dCA9IGJhY2tCdXR0b25FbC50ZXh0O1xuICBjbG9uZWRCYWNrQnV0dG9uRWwubW9kZSA9IGJhY2tCdXR0b25FbC5tb2RlO1xuICBjbG9uZWRCYWNrQnV0dG9uRWwuaWNvbiA9IGJhY2tCdXR0b25FbC5pY29uO1xuICBjbG9uZWRCYWNrQnV0dG9uRWwuY29sb3IgPSBiYWNrQnV0dG9uRWwuY29sb3I7XG4gIGNsb25lZEJhY2tCdXR0b25FbC5kaXNhYmxlZCA9IGJhY2tCdXR0b25FbC5kaXNhYmxlZDtcbiAgY2xvbmVkQmFja0J1dHRvbkVsLnN0eWxlLnNldFByb3BlcnR5KCdkaXNwbGF5JywgJ2Jsb2NrJyk7XG4gIGNsb25lZEJhY2tCdXR0b25FbC5zdHlsZS5zZXRQcm9wZXJ0eSgncG9zaXRpb24nLCAnZml4ZWQnKTtcbiAgZW50ZXJpbmdCYWNrQnV0dG9uSWNvbkFuaW1hdGlvbi5hZGRFbGVtZW50KGJhY2tCdXR0b25JY29uRWwpO1xuICBlbnRlcmluZ0JhY2tCdXR0b25UZXh0QW5pbWF0aW9uLmFkZEVsZW1lbnQoYmFja0J1dHRvblRleHRFbCk7XG4gIGVudGVyaW5nQmFja0J1dHRvblRleHRBbmltYXRpb25cbiAgICAuYmVmb3JlU3R5bGVzKHtcbiAgICAndHJhbnNmb3JtLW9yaWdpbic6IGAke1RFWFRfT1JJR0lOX1h9IGNlbnRlcmAsXG4gIH0pXG4gICAgLmJlZm9yZUFkZFdyaXRlKCgpID0+IHtcbiAgICBiYWNrQnV0dG9uRWwuc3R5bGUuc2V0UHJvcGVydHkoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgIGNsb25lZEJhY2tCdXR0b25FbC5zdHlsZS5zZXRQcm9wZXJ0eShURVhUX09SSUdJTl9YLCBCQUNLX0JVVFRPTl9TVEFSVF9PRkZTRVQpO1xuICB9KVxuICAgIC5hZnRlckFkZFdyaXRlKCgpID0+IHtcbiAgICBiYWNrQnV0dG9uRWwuc3R5bGUuc2V0UHJvcGVydHkoJ2Rpc3BsYXknLCAnJyk7XG4gICAgY2xvbmVkQmFja0J1dHRvbkVsLnN0eWxlLnNldFByb3BlcnR5KCdkaXNwbGF5JywgJ25vbmUnKTtcbiAgICBjbG9uZWRCYWNrQnV0dG9uRWwuc3R5bGUucmVtb3ZlUHJvcGVydHkoVEVYVF9PUklHSU5fWCk7XG4gIH0pXG4gICAgLmtleWZyYW1lcyhURVhUX0tFWUZSQU1FUyk7XG4gIGVudGVyaW5nQmFja0J1dHRvbkljb25BbmltYXRpb25cbiAgICAuYmVmb3JlU3R5bGVzKHtcbiAgICAndHJhbnNmb3JtLW9yaWdpbic6IGAke0lDT05fT1JJR0lOX1h9IGNlbnRlcmAsXG4gIH0pXG4gICAgLmtleWZyYW1lcyhJQ09OX0tFWUZSQU1FUyk7XG4gIHJvb3RBbmltYXRpb24uYWRkQW5pbWF0aW9uKFtlbnRlcmluZ0JhY2tCdXR0b25UZXh0QW5pbWF0aW9uLCBlbnRlcmluZ0JhY2tCdXR0b25JY29uQW5pbWF0aW9uXSk7XG59O1xuY29uc3QgYW5pbWF0ZUxhcmdlVGl0bGUgPSAocm9vdEFuaW1hdGlvbiwgcnRsLCBiYWNrRGlyZWN0aW9uLCBsYXJnZVRpdGxlRWwsIGxhcmdlVGl0bGVCb3gsIGJhY2tCdXR0b25Cb3gpID0+IHtcbiAgY29uc3QgVElUTEVfU1RBUlRfT0ZGU0VUID0gcnRsID8gYGNhbGMoMTAwJSAtICR7bGFyZ2VUaXRsZUJveC5yaWdodH1weClgIDogYCR7bGFyZ2VUaXRsZUJveC5sZWZ0fXB4YDtcbiAgY29uc3QgU1RBUlRfVFJBTlNMQVRFID0gcnRsID8gJy0xOHB4JyA6ICcxOHB4JztcbiAgY29uc3QgT1JJR0lOX1ggPSBydGwgPyAncmlnaHQnIDogJ2xlZnQnO1xuICBjb25zdCBCQUNLV0FSRFNfS0VZRlJBTUVTID0gW1xuICAgIHsgb2Zmc2V0OiAwLCBvcGFjaXR5OiAwLCB0cmFuc2Zvcm06IGB0cmFuc2xhdGUzZCgke1NUQVJUX1RSQU5TTEFURX0sICR7YmFja0J1dHRvbkJveC50b3AgLSA0fXB4LCAwKSBzY2FsZSgwLjQ5KWAgfSxcbiAgICB7IG9mZnNldDogMC4xLCBvcGFjaXR5OiAwIH0sXG4gICAgeyBvZmZzZXQ6IDEsIG9wYWNpdHk6IDEsIHRyYW5zZm9ybTogYHRyYW5zbGF0ZTNkKDAsICR7bGFyZ2VUaXRsZUJveC50b3AgLSAyfXB4LCAwKSBzY2FsZSgxKWAgfSxcbiAgXTtcbiAgY29uc3QgRk9SV0FSRFNfS0VZRlJBTUVTID0gW1xuICAgIHsgb2Zmc2V0OiAwLCBvcGFjaXR5OiAwLjk5LCB0cmFuc2Zvcm06IGB0cmFuc2xhdGUzZCgwLCAke2xhcmdlVGl0bGVCb3gudG9wIC0gMn1weCwgMCkgc2NhbGUoMSlgIH0sXG4gICAgeyBvZmZzZXQ6IDAuNiwgb3BhY2l0eTogMCB9LFxuICAgIHsgb2Zmc2V0OiAxLCBvcGFjaXR5OiAwLCB0cmFuc2Zvcm06IGB0cmFuc2xhdGUzZCgke1NUQVJUX1RSQU5TTEFURX0sICR7YmFja0J1dHRvbkJveC50b3AgLSA0fXB4LCAwKSBzY2FsZSgwLjUpYCB9LFxuICBdO1xuICBjb25zdCBLRVlGUkFNRVMgPSBiYWNrRGlyZWN0aW9uID8gQkFDS1dBUkRTX0tFWUZSQU1FUyA6IEZPUldBUkRTX0tFWUZSQU1FUztcbiAgY29uc3QgY2xvbmVkVGl0bGVFbCA9IGdldENsb25lZEVsZW1lbnQoJ2lvbi10aXRsZScpO1xuICBjb25zdCBjbG9uZWRMYXJnZVRpdGxlQW5pbWF0aW9uID0gY3JlYXRlQW5pbWF0aW9uKCk7XG4gIGNsb25lZFRpdGxlRWwuaW5uZXJUZXh0ID0gbGFyZ2VUaXRsZUVsLmlubmVyVGV4dDtcbiAgY2xvbmVkVGl0bGVFbC5zaXplID0gbGFyZ2VUaXRsZUVsLnNpemU7XG4gIGNsb25lZFRpdGxlRWwuY29sb3IgPSBsYXJnZVRpdGxlRWwuY29sb3I7XG4gIGNsb25lZExhcmdlVGl0bGVBbmltYXRpb24uYWRkRWxlbWVudChjbG9uZWRUaXRsZUVsKTtcbiAgY2xvbmVkTGFyZ2VUaXRsZUFuaW1hdGlvblxuICAgIC5iZWZvcmVTdHlsZXMoe1xuICAgICd0cmFuc2Zvcm0tb3JpZ2luJzogYCR7T1JJR0lOX1h9IGNlbnRlcmAsXG4gICAgaGVpZ2h0OiAnNDZweCcsXG4gICAgZGlzcGxheTogJycsXG4gICAgcG9zaXRpb246ICdyZWxhdGl2ZScsXG4gICAgW09SSUdJTl9YXTogVElUTEVfU1RBUlRfT0ZGU0VULFxuICB9KVxuICAgIC5iZWZvcmVBZGRXcml0ZSgoKSA9PiB7XG4gICAgbGFyZ2VUaXRsZUVsLnN0eWxlLnNldFByb3BlcnR5KCdkaXNwbGF5JywgJ25vbmUnKTtcbiAgfSlcbiAgICAuYWZ0ZXJBZGRXcml0ZSgoKSA9PiB7XG4gICAgbGFyZ2VUaXRsZUVsLnN0eWxlLnNldFByb3BlcnR5KCdkaXNwbGF5JywgJycpO1xuICAgIGNsb25lZFRpdGxlRWwuc3R5bGUuc2V0UHJvcGVydHkoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICB9KVxuICAgIC5rZXlmcmFtZXMoS0VZRlJBTUVTKTtcbiAgcm9vdEFuaW1hdGlvbi5hZGRBbmltYXRpb24oY2xvbmVkTGFyZ2VUaXRsZUFuaW1hdGlvbik7XG59O1xuY29uc3QgaW9zVHJhbnNpdGlvbkFuaW1hdGlvbiA9IChuYXZFbCwgb3B0cykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IEVBU0lORyA9ICdjdWJpYy1iZXppZXIoMC4zMiwwLjcyLDAsMSknO1xuICAgIGNvbnN0IE9QQUNJVFkgPSAnb3BhY2l0eSc7XG4gICAgY29uc3QgVFJBTlNGT1JNID0gJ3RyYW5zZm9ybSc7XG4gICAgY29uc3QgQ0VOVEVSID0gJzAlJztcbiAgICBjb25zdCBPRkZfT1BBQ0lUWSA9IDAuODtcbiAgICBjb25zdCBpc1JUTCA9IG5hdkVsLm93bmVyRG9jdW1lbnQuZGlyID09PSAncnRsJztcbiAgICBjb25zdCBPRkZfUklHSFQgPSBpc1JUTCA/ICctOTkuNSUnIDogJzk5LjUlJztcbiAgICBjb25zdCBPRkZfTEVGVCA9IGlzUlRMID8gJzMzJScgOiAnLTMzJSc7XG4gICAgY29uc3QgZW50ZXJpbmdFbCA9IG9wdHMuZW50ZXJpbmdFbDtcbiAgICBjb25zdCBsZWF2aW5nRWwgPSBvcHRzLmxlYXZpbmdFbDtcbiAgICBjb25zdCBiYWNrRGlyZWN0aW9uID0gb3B0cy5kaXJlY3Rpb24gPT09ICdiYWNrJztcbiAgICBjb25zdCBjb250ZW50RWwgPSBlbnRlcmluZ0VsLnF1ZXJ5U2VsZWN0b3IoJzpzY29wZSA+IGlvbi1jb250ZW50Jyk7XG4gICAgY29uc3QgaGVhZGVyRWxzID0gZW50ZXJpbmdFbC5xdWVyeVNlbGVjdG9yQWxsKCc6c2NvcGUgPiBpb24taGVhZGVyID4gKjpub3QoaW9uLXRvb2xiYXIpLCA6c2NvcGUgPiBpb24tZm9vdGVyID4gKicpO1xuICAgIGNvbnN0IGVudGVyaW5nVG9vbEJhckVscyA9IGVudGVyaW5nRWwucXVlcnlTZWxlY3RvckFsbCgnOnNjb3BlID4gaW9uLWhlYWRlciA+IGlvbi10b29sYmFyJyk7XG4gICAgY29uc3Qgcm9vdEFuaW1hdGlvbiA9IGNyZWF0ZUFuaW1hdGlvbigpO1xuICAgIGNvbnN0IGVudGVyaW5nQ29udGVudEFuaW1hdGlvbiA9IGNyZWF0ZUFuaW1hdGlvbigpO1xuICAgIHJvb3RBbmltYXRpb25cbiAgICAgIC5hZGRFbGVtZW50KGVudGVyaW5nRWwpXG4gICAgICAuZHVyYXRpb24ob3B0cy5kdXJhdGlvbiB8fCBEVVJBVElPTilcbiAgICAgIC5lYXNpbmcob3B0cy5lYXNpbmcgfHwgRUFTSU5HKVxuICAgICAgLmZpbGwoJ2JvdGgnKVxuICAgICAgLmJlZm9yZVJlbW92ZUNsYXNzKCdpb24tcGFnZS1pbnZpc2libGUnKTtcbiAgICBpZiAobGVhdmluZ0VsICYmIG5hdkVsKSB7XG4gICAgICBjb25zdCBuYXZEZWNvckFuaW1hdGlvbiA9IGNyZWF0ZUFuaW1hdGlvbigpO1xuICAgICAgbmF2RGVjb3JBbmltYXRpb24uYWRkRWxlbWVudChuYXZFbCk7XG4gICAgICByb290QW5pbWF0aW9uLmFkZEFuaW1hdGlvbihuYXZEZWNvckFuaW1hdGlvbik7XG4gICAgfVxuICAgIGlmICghY29udGVudEVsICYmIGVudGVyaW5nVG9vbEJhckVscy5sZW5ndGggPT09IDAgJiYgaGVhZGVyRWxzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgZW50ZXJpbmdDb250ZW50QW5pbWF0aW9uLmFkZEVsZW1lbnQoZW50ZXJpbmdFbC5xdWVyeVNlbGVjdG9yKCc6c2NvcGUgPiAuaW9uLXBhZ2UsIDpzY29wZSA+IGlvbi1uYXYsIDpzY29wZSA+IGlvbi10YWJzJykpOyAvLyBSRVZJRVdcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBlbnRlcmluZ0NvbnRlbnRBbmltYXRpb24uYWRkRWxlbWVudChjb250ZW50RWwpOyAvLyBSRVZJRVdcbiAgICAgIGVudGVyaW5nQ29udGVudEFuaW1hdGlvbi5hZGRFbGVtZW50KGhlYWRlckVscyk7XG4gICAgfVxuICAgIHJvb3RBbmltYXRpb24uYWRkQW5pbWF0aW9uKGVudGVyaW5nQ29udGVudEFuaW1hdGlvbik7XG4gICAgaWYgKGJhY2tEaXJlY3Rpb24pIHtcbiAgICAgIGVudGVyaW5nQ29udGVudEFuaW1hdGlvblxuICAgICAgICAuYmVmb3JlQ2xlYXJTdHlsZXMoW09QQUNJVFldKVxuICAgICAgICAuZnJvbVRvKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlWCgke09GRl9MRUZUfSlgLCBgdHJhbnNsYXRlWCgke0NFTlRFUn0pYClcbiAgICAgICAgLmZyb21UbyhPUEFDSVRZLCBPRkZfT1BBQ0lUWSwgMSk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgLy8gZW50ZXJpbmcgY29udGVudCwgZm9yd2FyZCBkaXJlY3Rpb25cbiAgICAgIGVudGVyaW5nQ29udGVudEFuaW1hdGlvblxuICAgICAgICAuYmVmb3JlQ2xlYXJTdHlsZXMoW09QQUNJVFldKVxuICAgICAgICAuZnJvbVRvKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlWCgke09GRl9SSUdIVH0pYCwgYHRyYW5zbGF0ZVgoJHtDRU5URVJ9KWApO1xuICAgIH1cbiAgICBpZiAoY29udGVudEVsKSB7XG4gICAgICBjb25zdCBlbnRlcmluZ1RyYW5zaXRpb25FZmZlY3RFbCA9IHNoYWRvdyhjb250ZW50RWwpLnF1ZXJ5U2VsZWN0b3IoJy50cmFuc2l0aW9uLWVmZmVjdCcpO1xuICAgICAgaWYgKGVudGVyaW5nVHJhbnNpdGlvbkVmZmVjdEVsKSB7XG4gICAgICAgIGNvbnN0IGVudGVyaW5nVHJhbnNpdGlvbkNvdmVyRWwgPSBlbnRlcmluZ1RyYW5zaXRpb25FZmZlY3RFbC5xdWVyeVNlbGVjdG9yKCcudHJhbnNpdGlvbi1jb3ZlcicpO1xuICAgICAgICBjb25zdCBlbnRlcmluZ1RyYW5zaXRpb25TaGFkb3dFbCA9IGVudGVyaW5nVHJhbnNpdGlvbkVmZmVjdEVsLnF1ZXJ5U2VsZWN0b3IoJy50cmFuc2l0aW9uLXNoYWRvdycpO1xuICAgICAgICBjb25zdCBlbnRlcmluZ1RyYW5zaXRpb25FZmZlY3QgPSBjcmVhdGVBbmltYXRpb24oKTtcbiAgICAgICAgY29uc3QgZW50ZXJpbmdUcmFuc2l0aW9uQ292ZXIgPSBjcmVhdGVBbmltYXRpb24oKTtcbiAgICAgICAgY29uc3QgZW50ZXJpbmdUcmFuc2l0aW9uU2hhZG93ID0gY3JlYXRlQW5pbWF0aW9uKCk7XG4gICAgICAgIGVudGVyaW5nVHJhbnNpdGlvbkVmZmVjdFxuICAgICAgICAgIC5hZGRFbGVtZW50KGVudGVyaW5nVHJhbnNpdGlvbkVmZmVjdEVsKVxuICAgICAgICAgIC5iZWZvcmVTdHlsZXMoeyBvcGFjaXR5OiAnMScsIGRpc3BsYXk6ICdibG9jaycgfSlcbiAgICAgICAgICAuYWZ0ZXJTdHlsZXMoeyBvcGFjaXR5OiAnJywgZGlzcGxheTogJycgfSk7XG4gICAgICAgIGVudGVyaW5nVHJhbnNpdGlvbkNvdmVyXG4gICAgICAgICAgLmFkZEVsZW1lbnQoZW50ZXJpbmdUcmFuc2l0aW9uQ292ZXJFbCkgLy8gUkVWSUVXXG4gICAgICAgICAgLmJlZm9yZUNsZWFyU3R5bGVzKFtPUEFDSVRZXSlcbiAgICAgICAgICAuZnJvbVRvKE9QQUNJVFksIDAsIDAuMSk7XG4gICAgICAgIGVudGVyaW5nVHJhbnNpdGlvblNoYWRvd1xuICAgICAgICAgIC5hZGRFbGVtZW50KGVudGVyaW5nVHJhbnNpdGlvblNoYWRvd0VsKSAvLyBSRVZJRVdcbiAgICAgICAgICAuYmVmb3JlQ2xlYXJTdHlsZXMoW09QQUNJVFldKVxuICAgICAgICAgIC5mcm9tVG8oT1BBQ0lUWSwgMC4wMywgMC43KTtcbiAgICAgICAgZW50ZXJpbmdUcmFuc2l0aW9uRWZmZWN0LmFkZEFuaW1hdGlvbihbZW50ZXJpbmdUcmFuc2l0aW9uQ292ZXIsIGVudGVyaW5nVHJhbnNpdGlvblNoYWRvd10pO1xuICAgICAgICBlbnRlcmluZ0NvbnRlbnRBbmltYXRpb24uYWRkQW5pbWF0aW9uKFtlbnRlcmluZ1RyYW5zaXRpb25FZmZlY3RdKTtcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgZW50ZXJpbmdDb250ZW50SGFzTGFyZ2VUaXRsZSA9IGVudGVyaW5nRWwucXVlcnlTZWxlY3RvcignaW9uLWhlYWRlci5oZWFkZXItY29sbGFwc2UtY29uZGVuc2UnKTtcbiAgICBjb25zdCB7IGZvcndhcmQsIGJhY2t3YXJkIH0gPSBjcmVhdGVMYXJnZVRpdGxlVHJhbnNpdGlvbihyb290QW5pbWF0aW9uLCBpc1JUTCwgYmFja0RpcmVjdGlvbiwgZW50ZXJpbmdFbCwgbGVhdmluZ0VsKTtcbiAgICBlbnRlcmluZ1Rvb2xCYXJFbHMuZm9yRWFjaCgoZW50ZXJpbmdUb29sQmFyRWwpID0+IHtcbiAgICAgIGNvbnN0IGVudGVyaW5nVG9vbEJhciA9IGNyZWF0ZUFuaW1hdGlvbigpO1xuICAgICAgZW50ZXJpbmdUb29sQmFyLmFkZEVsZW1lbnQoZW50ZXJpbmdUb29sQmFyRWwpO1xuICAgICAgcm9vdEFuaW1hdGlvbi5hZGRBbmltYXRpb24oZW50ZXJpbmdUb29sQmFyKTtcbiAgICAgIGNvbnN0IGVudGVyaW5nVGl0bGUgPSBjcmVhdGVBbmltYXRpb24oKTtcbiAgICAgIGVudGVyaW5nVGl0bGUuYWRkRWxlbWVudChlbnRlcmluZ1Rvb2xCYXJFbC5xdWVyeVNlbGVjdG9yKCdpb24tdGl0bGUnKSk7IC8vIFJFVklFV1xuICAgICAgY29uc3QgZW50ZXJpbmdUb29sQmFyQnV0dG9ucyA9IGNyZWF0ZUFuaW1hdGlvbigpO1xuICAgICAgY29uc3QgYnV0dG9ucyA9IEFycmF5LmZyb20oZW50ZXJpbmdUb29sQmFyRWwucXVlcnlTZWxlY3RvckFsbCgnaW9uLWJ1dHRvbnMsW21lbnVUb2dnbGVdJykpO1xuICAgICAgY29uc3QgcGFyZW50SGVhZGVyID0gZW50ZXJpbmdUb29sQmFyRWwuY2xvc2VzdCgnaW9uLWhlYWRlcicpO1xuICAgICAgY29uc3QgaW5hY3RpdmVIZWFkZXIgPSBwYXJlbnRIZWFkZXIgPT09IG51bGwgfHwgcGFyZW50SGVhZGVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwYXJlbnRIZWFkZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdoZWFkZXItY29sbGFwc2UtY29uZGVuc2UtaW5hY3RpdmUnKTtcbiAgICAgIGxldCBidXR0b25zVG9BbmltYXRlO1xuICAgICAgaWYgKGJhY2tEaXJlY3Rpb24pIHtcbiAgICAgICAgYnV0dG9uc1RvQW5pbWF0ZSA9IGJ1dHRvbnMuZmlsdGVyKChidXR0b24pID0+IHtcbiAgICAgICAgICBjb25zdCBpc0NvbGxhcHNlQnV0dG9uID0gYnV0dG9uLmNsYXNzTGlzdC5jb250YWlucygnYnV0dG9ucy1jb2xsYXBzZScpO1xuICAgICAgICAgIHJldHVybiAoaXNDb2xsYXBzZUJ1dHRvbiAmJiAhaW5hY3RpdmVIZWFkZXIpIHx8ICFpc0NvbGxhcHNlQnV0dG9uO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBidXR0b25zVG9BbmltYXRlID0gYnV0dG9ucy5maWx0ZXIoKGJ1dHRvbikgPT4gIWJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ2J1dHRvbnMtY29sbGFwc2UnKSk7XG4gICAgICB9XG4gICAgICBlbnRlcmluZ1Rvb2xCYXJCdXR0b25zLmFkZEVsZW1lbnQoYnV0dG9uc1RvQW5pbWF0ZSk7XG4gICAgICBjb25zdCBlbnRlcmluZ1Rvb2xCYXJJdGVtcyA9IGNyZWF0ZUFuaW1hdGlvbigpO1xuICAgICAgZW50ZXJpbmdUb29sQmFySXRlbXMuYWRkRWxlbWVudChlbnRlcmluZ1Rvb2xCYXJFbC5xdWVyeVNlbGVjdG9yQWxsKCc6c2NvcGUgPiAqOm5vdChpb24tdGl0bGUpOm5vdChpb24tYnV0dG9ucyk6bm90KFttZW51VG9nZ2xlXSknKSk7XG4gICAgICBjb25zdCBlbnRlcmluZ1Rvb2xCYXJCZyA9IGNyZWF0ZUFuaW1hdGlvbigpO1xuICAgICAgZW50ZXJpbmdUb29sQmFyQmcuYWRkRWxlbWVudChzaGFkb3coZW50ZXJpbmdUb29sQmFyRWwpLnF1ZXJ5U2VsZWN0b3IoJy50b29sYmFyLWJhY2tncm91bmQnKSk7IC8vIFJFVklFV1xuICAgICAgY29uc3QgZW50ZXJpbmdCYWNrQnV0dG9uID0gY3JlYXRlQW5pbWF0aW9uKCk7XG4gICAgICBjb25zdCBiYWNrQnV0dG9uRWwgPSBlbnRlcmluZ1Rvb2xCYXJFbC5xdWVyeVNlbGVjdG9yKCdpb24tYmFjay1idXR0b24nKTtcbiAgICAgIGlmIChiYWNrQnV0dG9uRWwpIHtcbiAgICAgICAgZW50ZXJpbmdCYWNrQnV0dG9uLmFkZEVsZW1lbnQoYmFja0J1dHRvbkVsKTtcbiAgICAgIH1cbiAgICAgIGVudGVyaW5nVG9vbEJhci5hZGRBbmltYXRpb24oW1xuICAgICAgICBlbnRlcmluZ1RpdGxlLFxuICAgICAgICBlbnRlcmluZ1Rvb2xCYXJCdXR0b25zLFxuICAgICAgICBlbnRlcmluZ1Rvb2xCYXJJdGVtcyxcbiAgICAgICAgZW50ZXJpbmdUb29sQmFyQmcsXG4gICAgICAgIGVudGVyaW5nQmFja0J1dHRvbixcbiAgICAgIF0pO1xuICAgICAgZW50ZXJpbmdUb29sQmFyQnV0dG9ucy5mcm9tVG8oT1BBQ0lUWSwgMC4wMSwgMSk7XG4gICAgICBlbnRlcmluZ1Rvb2xCYXJJdGVtcy5mcm9tVG8oT1BBQ0lUWSwgMC4wMSwgMSk7XG4gICAgICBpZiAoYmFja0RpcmVjdGlvbikge1xuICAgICAgICBpZiAoIWluYWN0aXZlSGVhZGVyKSB7XG4gICAgICAgICAgZW50ZXJpbmdUaXRsZVxuICAgICAgICAgICAgLmZyb21UbygndHJhbnNmb3JtJywgYHRyYW5zbGF0ZVgoJHtPRkZfTEVGVH0pYCwgYHRyYW5zbGF0ZVgoJHtDRU5URVJ9KWApXG4gICAgICAgICAgICAuZnJvbVRvKE9QQUNJVFksIDAuMDEsIDEpO1xuICAgICAgICB9XG4gICAgICAgIGVudGVyaW5nVG9vbEJhckl0ZW1zLmZyb21UbygndHJhbnNmb3JtJywgYHRyYW5zbGF0ZVgoJHtPRkZfTEVGVH0pYCwgYHRyYW5zbGF0ZVgoJHtDRU5URVJ9KWApO1xuICAgICAgICAvLyBiYWNrIGRpcmVjdGlvbiwgZW50ZXJpbmcgcGFnZSBoYXMgYSBiYWNrIGJ1dHRvblxuICAgICAgICBlbnRlcmluZ0JhY2tCdXR0b24uZnJvbVRvKE9QQUNJVFksIDAuMDEsIDEpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIC8vIGVudGVyaW5nIHRvb2xiYXIsIGZvcndhcmQgZGlyZWN0aW9uXG4gICAgICAgIGlmICghZW50ZXJpbmdDb250ZW50SGFzTGFyZ2VUaXRsZSkge1xuICAgICAgICAgIGVudGVyaW5nVGl0bGVcbiAgICAgICAgICAgIC5mcm9tVG8oJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGVYKCR7T0ZGX1JJR0hUfSlgLCBgdHJhbnNsYXRlWCgke0NFTlRFUn0pYClcbiAgICAgICAgICAgIC5mcm9tVG8oT1BBQ0lUWSwgMC4wMSwgMSk7XG4gICAgICAgIH1cbiAgICAgICAgZW50ZXJpbmdUb29sQmFySXRlbXMuZnJvbVRvKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlWCgke09GRl9SSUdIVH0pYCwgYHRyYW5zbGF0ZVgoJHtDRU5URVJ9KWApO1xuICAgICAgICBlbnRlcmluZ1Rvb2xCYXJCZy5iZWZvcmVDbGVhclN0eWxlcyhbT1BBQ0lUWSwgJ3RyYW5zZm9ybSddKTtcbiAgICAgICAgY29uc3QgdHJhbnNsdWNlbnRIZWFkZXIgPSBwYXJlbnRIZWFkZXIgPT09IG51bGwgfHwgcGFyZW50SGVhZGVyID09PSB2b2lkIDAgPyB2b2lkIDAgOiBwYXJlbnRIZWFkZXIudHJhbnNsdWNlbnQ7XG4gICAgICAgIGlmICghdHJhbnNsdWNlbnRIZWFkZXIpIHtcbiAgICAgICAgICBlbnRlcmluZ1Rvb2xCYXJCZy5mcm9tVG8oT1BBQ0lUWSwgMC4wMSwgJ3ZhcigtLW9wYWNpdHkpJyk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgZW50ZXJpbmdUb29sQmFyQmcuZnJvbVRvKCd0cmFuc2Zvcm0nLCBpc1JUTCA/ICd0cmFuc2xhdGVYKC0xMDAlKScgOiAndHJhbnNsYXRlWCgxMDAlKScsICd0cmFuc2xhdGVYKDBweCknKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBmb3J3YXJkIGRpcmVjdGlvbiwgZW50ZXJpbmcgcGFnZSBoYXMgYSBiYWNrIGJ1dHRvblxuICAgICAgICBpZiAoIWZvcndhcmQpIHtcbiAgICAgICAgICBlbnRlcmluZ0JhY2tCdXR0b24uZnJvbVRvKE9QQUNJVFksIDAuMDEsIDEpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChiYWNrQnV0dG9uRWwgJiYgIWZvcndhcmQpIHtcbiAgICAgICAgICBjb25zdCBlbnRlcmluZ0JhY2tCdG5UZXh0ID0gY3JlYXRlQW5pbWF0aW9uKCk7XG4gICAgICAgICAgZW50ZXJpbmdCYWNrQnRuVGV4dFxuICAgICAgICAgICAgLmFkZEVsZW1lbnQoc2hhZG93KGJhY2tCdXR0b25FbCkucXVlcnlTZWxlY3RvcignLmJ1dHRvbi10ZXh0JykpIC8vIFJFVklFV1xuICAgICAgICAgICAgLmZyb21UbyhgdHJhbnNmb3JtYCwgaXNSVEwgPyAndHJhbnNsYXRlWCgtMTAwcHgpJyA6ICd0cmFuc2xhdGVYKDEwMHB4KScsICd0cmFuc2xhdGVYKDBweCknKTtcbiAgICAgICAgICBlbnRlcmluZ1Rvb2xCYXIuYWRkQW5pbWF0aW9uKGVudGVyaW5nQmFja0J0blRleHQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgLy8gc2V0dXAgbGVhdmluZyB2aWV3XG4gICAgaWYgKGxlYXZpbmdFbCkge1xuICAgICAgY29uc3QgbGVhdmluZ0NvbnRlbnQgPSBjcmVhdGVBbmltYXRpb24oKTtcbiAgICAgIGNvbnN0IGxlYXZpbmdDb250ZW50RWwgPSBsZWF2aW5nRWwucXVlcnlTZWxlY3RvcignOnNjb3BlID4gaW9uLWNvbnRlbnQnKTtcbiAgICAgIGNvbnN0IGxlYXZpbmdUb29sQmFyRWxzID0gbGVhdmluZ0VsLnF1ZXJ5U2VsZWN0b3JBbGwoJzpzY29wZSA+IGlvbi1oZWFkZXIgPiBpb24tdG9vbGJhcicpO1xuICAgICAgY29uc3QgbGVhdmluZ0hlYWRlckVscyA9IGxlYXZpbmdFbC5xdWVyeVNlbGVjdG9yQWxsKCc6c2NvcGUgPiBpb24taGVhZGVyID4gKjpub3QoaW9uLXRvb2xiYXIpLCA6c2NvcGUgPiBpb24tZm9vdGVyID4gKicpO1xuICAgICAgaWYgKCFsZWF2aW5nQ29udGVudEVsICYmIGxlYXZpbmdUb29sQmFyRWxzLmxlbmd0aCA9PT0gMCAmJiBsZWF2aW5nSGVhZGVyRWxzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBsZWF2aW5nQ29udGVudC5hZGRFbGVtZW50KGxlYXZpbmdFbC5xdWVyeVNlbGVjdG9yKCc6c2NvcGUgPiAuaW9uLXBhZ2UsIDpzY29wZSA+IGlvbi1uYXYsIDpzY29wZSA+IGlvbi10YWJzJykpOyAvLyBSRVZJRVdcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICBsZWF2aW5nQ29udGVudC5hZGRFbGVtZW50KGxlYXZpbmdDb250ZW50RWwpOyAvLyBSRVZJRVdcbiAgICAgICAgbGVhdmluZ0NvbnRlbnQuYWRkRWxlbWVudChsZWF2aW5nSGVhZGVyRWxzKTtcbiAgICAgIH1cbiAgICAgIHJvb3RBbmltYXRpb24uYWRkQW5pbWF0aW9uKGxlYXZpbmdDb250ZW50KTtcbiAgICAgIGlmIChiYWNrRGlyZWN0aW9uKSB7XG4gICAgICAgIC8vIGxlYXZpbmcgY29udGVudCwgYmFjayBkaXJlY3Rpb25cbiAgICAgICAgbGVhdmluZ0NvbnRlbnRcbiAgICAgICAgICAuYmVmb3JlQ2xlYXJTdHlsZXMoW09QQUNJVFldKVxuICAgICAgICAgIC5mcm9tVG8oJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGVYKCR7Q0VOVEVSfSlgLCBpc1JUTCA/ICd0cmFuc2xhdGVYKC0xMDAlKScgOiAndHJhbnNsYXRlWCgxMDAlKScpO1xuICAgICAgICBjb25zdCBsZWF2aW5nUGFnZSA9IGdldElvblBhZ2VFbGVtZW50KGxlYXZpbmdFbCk7XG4gICAgICAgIHJvb3RBbmltYXRpb24uYWZ0ZXJBZGRXcml0ZSgoKSA9PiB7XG4gICAgICAgICAgaWYgKHJvb3RBbmltYXRpb24uZ2V0RGlyZWN0aW9uKCkgPT09ICdub3JtYWwnKSB7XG4gICAgICAgICAgICBsZWF2aW5nUGFnZS5zdHlsZS5zZXRQcm9wZXJ0eSgnZGlzcGxheScsICdub25lJyk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICAvLyBsZWF2aW5nIGNvbnRlbnQsIGZvcndhcmQgZGlyZWN0aW9uXG4gICAgICAgIGxlYXZpbmdDb250ZW50XG4gICAgICAgICAgLmZyb21UbygndHJhbnNmb3JtJywgYHRyYW5zbGF0ZVgoJHtDRU5URVJ9KWAsIGB0cmFuc2xhdGVYKCR7T0ZGX0xFRlR9KWApXG4gICAgICAgICAgLmZyb21UbyhPUEFDSVRZLCAxLCBPRkZfT1BBQ0lUWSk7XG4gICAgICB9XG4gICAgICBpZiAobGVhdmluZ0NvbnRlbnRFbCkge1xuICAgICAgICBjb25zdCBsZWF2aW5nVHJhbnNpdGlvbkVmZmVjdEVsID0gc2hhZG93KGxlYXZpbmdDb250ZW50RWwpLnF1ZXJ5U2VsZWN0b3IoJy50cmFuc2l0aW9uLWVmZmVjdCcpO1xuICAgICAgICBpZiAobGVhdmluZ1RyYW5zaXRpb25FZmZlY3RFbCkge1xuICAgICAgICAgIGNvbnN0IGxlYXZpbmdUcmFuc2l0aW9uQ292ZXJFbCA9IGxlYXZpbmdUcmFuc2l0aW9uRWZmZWN0RWwucXVlcnlTZWxlY3RvcignLnRyYW5zaXRpb24tY292ZXInKTtcbiAgICAgICAgICBjb25zdCBsZWF2aW5nVHJhbnNpdGlvblNoYWRvd0VsID0gbGVhdmluZ1RyYW5zaXRpb25FZmZlY3RFbC5xdWVyeVNlbGVjdG9yKCcudHJhbnNpdGlvbi1zaGFkb3cnKTtcbiAgICAgICAgICBjb25zdCBsZWF2aW5nVHJhbnNpdGlvbkVmZmVjdCA9IGNyZWF0ZUFuaW1hdGlvbigpO1xuICAgICAgICAgIGNvbnN0IGxlYXZpbmdUcmFuc2l0aW9uQ292ZXIgPSBjcmVhdGVBbmltYXRpb24oKTtcbiAgICAgICAgICBjb25zdCBsZWF2aW5nVHJhbnNpdGlvblNoYWRvdyA9IGNyZWF0ZUFuaW1hdGlvbigpO1xuICAgICAgICAgIGxlYXZpbmdUcmFuc2l0aW9uRWZmZWN0XG4gICAgICAgICAgICAuYWRkRWxlbWVudChsZWF2aW5nVHJhbnNpdGlvbkVmZmVjdEVsKVxuICAgICAgICAgICAgLmJlZm9yZVN0eWxlcyh7IG9wYWNpdHk6ICcxJywgZGlzcGxheTogJ2Jsb2NrJyB9KVxuICAgICAgICAgICAgLmFmdGVyU3R5bGVzKHsgb3BhY2l0eTogJycsIGRpc3BsYXk6ICcnIH0pO1xuICAgICAgICAgIGxlYXZpbmdUcmFuc2l0aW9uQ292ZXJcbiAgICAgICAgICAgIC5hZGRFbGVtZW50KGxlYXZpbmdUcmFuc2l0aW9uQ292ZXJFbCkgLy8gUkVWSUVXXG4gICAgICAgICAgICAuYmVmb3JlQ2xlYXJTdHlsZXMoW09QQUNJVFldKVxuICAgICAgICAgICAgLmZyb21UbyhPUEFDSVRZLCAwLjEsIDApO1xuICAgICAgICAgIGxlYXZpbmdUcmFuc2l0aW9uU2hhZG93XG4gICAgICAgICAgICAuYWRkRWxlbWVudChsZWF2aW5nVHJhbnNpdGlvblNoYWRvd0VsKSAvLyBSRVZJRVdcbiAgICAgICAgICAgIC5iZWZvcmVDbGVhclN0eWxlcyhbT1BBQ0lUWV0pXG4gICAgICAgICAgICAuZnJvbVRvKE9QQUNJVFksIDAuNywgMC4wMyk7XG4gICAgICAgICAgbGVhdmluZ1RyYW5zaXRpb25FZmZlY3QuYWRkQW5pbWF0aW9uKFtsZWF2aW5nVHJhbnNpdGlvbkNvdmVyLCBsZWF2aW5nVHJhbnNpdGlvblNoYWRvd10pO1xuICAgICAgICAgIGxlYXZpbmdDb250ZW50LmFkZEFuaW1hdGlvbihbbGVhdmluZ1RyYW5zaXRpb25FZmZlY3RdKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbGVhdmluZ1Rvb2xCYXJFbHMuZm9yRWFjaCgobGVhdmluZ1Rvb2xCYXJFbCkgPT4ge1xuICAgICAgICBjb25zdCBsZWF2aW5nVG9vbEJhciA9IGNyZWF0ZUFuaW1hdGlvbigpO1xuICAgICAgICBsZWF2aW5nVG9vbEJhci5hZGRFbGVtZW50KGxlYXZpbmdUb29sQmFyRWwpO1xuICAgICAgICBjb25zdCBsZWF2aW5nVGl0bGUgPSBjcmVhdGVBbmltYXRpb24oKTtcbiAgICAgICAgbGVhdmluZ1RpdGxlLmFkZEVsZW1lbnQobGVhdmluZ1Rvb2xCYXJFbC5xdWVyeVNlbGVjdG9yKCdpb24tdGl0bGUnKSk7IC8vIFJFVklFV1xuICAgICAgICBjb25zdCBsZWF2aW5nVG9vbEJhckJ1dHRvbnMgPSBjcmVhdGVBbmltYXRpb24oKTtcbiAgICAgICAgY29uc3QgYnV0dG9ucyA9IGxlYXZpbmdUb29sQmFyRWwucXVlcnlTZWxlY3RvckFsbCgnaW9uLWJ1dHRvbnMsW21lbnVUb2dnbGVdJyk7XG4gICAgICAgIGNvbnN0IHBhcmVudEhlYWRlciA9IGxlYXZpbmdUb29sQmFyRWwuY2xvc2VzdCgnaW9uLWhlYWRlcicpO1xuICAgICAgICBjb25zdCBpbmFjdGl2ZUhlYWRlciA9IHBhcmVudEhlYWRlciA9PT0gbnVsbCB8fCBwYXJlbnRIZWFkZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBhcmVudEhlYWRlci5jbGFzc0xpc3QuY29udGFpbnMoJ2hlYWRlci1jb2xsYXBzZS1jb25kZW5zZS1pbmFjdGl2ZScpO1xuICAgICAgICBjb25zdCBidXR0b25zVG9BbmltYXRlID0gQXJyYXkuZnJvbShidXR0b25zKS5maWx0ZXIoKGJ1dHRvbikgPT4ge1xuICAgICAgICAgIGNvbnN0IGlzQ29sbGFwc2VCdXR0b24gPSBidXR0b24uY2xhc3NMaXN0LmNvbnRhaW5zKCdidXR0b25zLWNvbGxhcHNlJyk7XG4gICAgICAgICAgcmV0dXJuIChpc0NvbGxhcHNlQnV0dG9uICYmICFpbmFjdGl2ZUhlYWRlcikgfHwgIWlzQ29sbGFwc2VCdXR0b247XG4gICAgICAgIH0pO1xuICAgICAgICBsZWF2aW5nVG9vbEJhckJ1dHRvbnMuYWRkRWxlbWVudChidXR0b25zVG9BbmltYXRlKTtcbiAgICAgICAgY29uc3QgbGVhdmluZ1Rvb2xCYXJJdGVtcyA9IGNyZWF0ZUFuaW1hdGlvbigpO1xuICAgICAgICBjb25zdCBsZWF2aW5nVG9vbEJhckl0ZW1FbHMgPSBsZWF2aW5nVG9vbEJhckVsLnF1ZXJ5U2VsZWN0b3JBbGwoJzpzY29wZSA+ICo6bm90KGlvbi10aXRsZSk6bm90KGlvbi1idXR0b25zKTpub3QoW21lbnVUb2dnbGVdKScpO1xuICAgICAgICBpZiAobGVhdmluZ1Rvb2xCYXJJdGVtRWxzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBsZWF2aW5nVG9vbEJhckl0ZW1zLmFkZEVsZW1lbnQobGVhdmluZ1Rvb2xCYXJJdGVtRWxzKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBsZWF2aW5nVG9vbEJhckJnID0gY3JlYXRlQW5pbWF0aW9uKCk7XG4gICAgICAgIGxlYXZpbmdUb29sQmFyQmcuYWRkRWxlbWVudChzaGFkb3cobGVhdmluZ1Rvb2xCYXJFbCkucXVlcnlTZWxlY3RvcignLnRvb2xiYXItYmFja2dyb3VuZCcpKTsgLy8gUkVWSUVXXG4gICAgICAgIGNvbnN0IGxlYXZpbmdCYWNrQnV0dG9uID0gY3JlYXRlQW5pbWF0aW9uKCk7XG4gICAgICAgIGNvbnN0IGJhY2tCdXR0b25FbCA9IGxlYXZpbmdUb29sQmFyRWwucXVlcnlTZWxlY3RvcignaW9uLWJhY2stYnV0dG9uJyk7XG4gICAgICAgIGlmIChiYWNrQnV0dG9uRWwpIHtcbiAgICAgICAgICBsZWF2aW5nQmFja0J1dHRvbi5hZGRFbGVtZW50KGJhY2tCdXR0b25FbCk7XG4gICAgICAgIH1cbiAgICAgICAgbGVhdmluZ1Rvb2xCYXIuYWRkQW5pbWF0aW9uKFtcbiAgICAgICAgICBsZWF2aW5nVGl0bGUsXG4gICAgICAgICAgbGVhdmluZ1Rvb2xCYXJCdXR0b25zLFxuICAgICAgICAgIGxlYXZpbmdUb29sQmFySXRlbXMsXG4gICAgICAgICAgbGVhdmluZ0JhY2tCdXR0b24sXG4gICAgICAgICAgbGVhdmluZ1Rvb2xCYXJCZyxcbiAgICAgICAgXSk7XG4gICAgICAgIHJvb3RBbmltYXRpb24uYWRkQW5pbWF0aW9uKGxlYXZpbmdUb29sQmFyKTtcbiAgICAgICAgLy8gZmFkZSBvdXQgbGVhdmluZyB0b29sYmFyIGl0ZW1zXG4gICAgICAgIGxlYXZpbmdCYWNrQnV0dG9uLmZyb21UbyhPUEFDSVRZLCAwLjk5LCAwKTtcbiAgICAgICAgbGVhdmluZ1Rvb2xCYXJCdXR0b25zLmZyb21UbyhPUEFDSVRZLCAwLjk5LCAwKTtcbiAgICAgICAgbGVhdmluZ1Rvb2xCYXJJdGVtcy5mcm9tVG8oT1BBQ0lUWSwgMC45OSwgMCk7XG4gICAgICAgIGlmIChiYWNrRGlyZWN0aW9uKSB7XG4gICAgICAgICAgaWYgKCFpbmFjdGl2ZUhlYWRlcikge1xuICAgICAgICAgICAgLy8gbGVhdmluZyB0b29sYmFyLCBiYWNrIGRpcmVjdGlvblxuICAgICAgICAgICAgbGVhdmluZ1RpdGxlXG4gICAgICAgICAgICAgIC5mcm9tVG8oJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGVYKCR7Q0VOVEVSfSlgLCBpc1JUTCA/ICd0cmFuc2xhdGVYKC0xMDAlKScgOiAndHJhbnNsYXRlWCgxMDAlKScpXG4gICAgICAgICAgICAgIC5mcm9tVG8oT1BBQ0lUWSwgMC45OSwgMCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGxlYXZpbmdUb29sQmFySXRlbXMuZnJvbVRvKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlWCgke0NFTlRFUn0pYCwgaXNSVEwgPyAndHJhbnNsYXRlWCgtMTAwJSknIDogJ3RyYW5zbGF0ZVgoMTAwJSknKTtcbiAgICAgICAgICBsZWF2aW5nVG9vbEJhckJnLmJlZm9yZUNsZWFyU3R5bGVzKFtPUEFDSVRZLCAndHJhbnNmb3JtJ10pO1xuICAgICAgICAgIC8vIGxlYXZpbmcgdG9vbGJhciwgYmFjayBkaXJlY3Rpb24sIGFuZCB0aGVyZSdzIG5vIGVudGVyaW5nIHRvb2xiYXJcbiAgICAgICAgICAvLyBzaG91bGQganVzdCBzbGlkZSBvdXQsIG5vIGZhZGluZyBvdXRcbiAgICAgICAgICBjb25zdCB0cmFuc2x1Y2VudEhlYWRlciA9IHBhcmVudEhlYWRlciA9PT0gbnVsbCB8fCBwYXJlbnRIZWFkZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBhcmVudEhlYWRlci50cmFuc2x1Y2VudDtcbiAgICAgICAgICBpZiAoIXRyYW5zbHVjZW50SGVhZGVyKSB7XG4gICAgICAgICAgICBsZWF2aW5nVG9vbEJhckJnLmZyb21UbyhPUEFDSVRZLCAndmFyKC0tb3BhY2l0eSknLCAwKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBsZWF2aW5nVG9vbEJhckJnLmZyb21UbygndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZVgoMHB4KScsIGlzUlRMID8gJ3RyYW5zbGF0ZVgoLTEwMCUpJyA6ICd0cmFuc2xhdGVYKDEwMCUpJyk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChiYWNrQnV0dG9uRWwgJiYgIWJhY2t3YXJkKSB7XG4gICAgICAgICAgICBjb25zdCBsZWF2aW5nQmFja0J0blRleHQgPSBjcmVhdGVBbmltYXRpb24oKTtcbiAgICAgICAgICAgIGxlYXZpbmdCYWNrQnRuVGV4dFxuICAgICAgICAgICAgICAuYWRkRWxlbWVudChzaGFkb3coYmFja0J1dHRvbkVsKS5xdWVyeVNlbGVjdG9yKCcuYnV0dG9uLXRleHQnKSkgLy8gUkVWSUVXXG4gICAgICAgICAgICAgIC5mcm9tVG8oJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGVYKCR7Q0VOVEVSfSlgLCBgdHJhbnNsYXRlWCgkeyhpc1JUTCA/IC0xMjQgOiAxMjQpICsgJ3B4J30pYCk7XG4gICAgICAgICAgICBsZWF2aW5nVG9vbEJhci5hZGRBbmltYXRpb24obGVhdmluZ0JhY2tCdG5UZXh0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgLy8gbGVhdmluZyB0b29sYmFyLCBmb3J3YXJkIGRpcmVjdGlvblxuICAgICAgICAgIGlmICghaW5hY3RpdmVIZWFkZXIpIHtcbiAgICAgICAgICAgIGxlYXZpbmdUaXRsZVxuICAgICAgICAgICAgICAuZnJvbVRvKCd0cmFuc2Zvcm0nLCBgdHJhbnNsYXRlWCgke0NFTlRFUn0pYCwgYHRyYW5zbGF0ZVgoJHtPRkZfTEVGVH0pYClcbiAgICAgICAgICAgICAgLmZyb21UbyhPUEFDSVRZLCAwLjk5LCAwKVxuICAgICAgICAgICAgICAuYWZ0ZXJDbGVhclN0eWxlcyhbVFJBTlNGT1JNLCBPUEFDSVRZXSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGxlYXZpbmdUb29sQmFySXRlbXNcbiAgICAgICAgICAgIC5mcm9tVG8oJ3RyYW5zZm9ybScsIGB0cmFuc2xhdGVYKCR7Q0VOVEVSfSlgLCBgdHJhbnNsYXRlWCgke09GRl9MRUZUfSlgKVxuICAgICAgICAgICAgLmFmdGVyQ2xlYXJTdHlsZXMoW1RSQU5TRk9STSwgT1BBQ0lUWV0pO1xuICAgICAgICAgIGxlYXZpbmdCYWNrQnV0dG9uLmFmdGVyQ2xlYXJTdHlsZXMoW09QQUNJVFldKTtcbiAgICAgICAgICBsZWF2aW5nVGl0bGUuYWZ0ZXJDbGVhclN0eWxlcyhbT1BBQ0lUWV0pO1xuICAgICAgICAgIGxlYXZpbmdUb29sQmFyQnV0dG9ucy5hZnRlckNsZWFyU3R5bGVzKFtPUEFDSVRZXSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICByZXR1cm4gcm9vdEFuaW1hdGlvbjtcbiAgfVxuICBjYXRjaCAoZXJyKSB7XG4gICAgdGhyb3cgZXJyO1xuICB9XG59O1xuXG5leHBvcnQgeyBpb3NUcmFuc2l0aW9uQW5pbWF0aW9uLCBzaGFkb3cgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///56338\n")}}]);